
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>admin-events</title>
    <link
      rel="canonical"
      href="https://getbootstrap.com/docs/5.3/examples/headers/"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"
    />

    <link href="https://getbootstrap.com/docs/5.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="HomePage.css" />
    


</head>
<body>
  
<div class="px-3 py-2 text-bg-dark border-bottom">
      <div class="container">
        <div
          class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start"
        >
          <a
            href="/"
            class="d-flex align-items-center my-2 my-lg-0 me-lg-auto text-white text-decoration-none"
          >
         
       
       
    

          </a>
      
          <ul
            class="nav col-12 col-lg-auto my-2 justify-content-center my-md-0 text-small"
          >
            <li>
              <a href="#" class="nav-link text-white">
                <svg class="bi d-block mx-auto mb-1 color-black" width="24" height="24" >
                  <use xlink:href="#home" />
                </svg>
                Home
              </a>
            </li>
              <li>
                  <a href="logout.php" class="nav-link text-white">
                    <svg class="bi d-block mx-auto mb-1" width="24" height="24">
                      <use xlink:href="#signout" />
                    </svg>
                    Sign Out
                  </a>
                </li>
      
          </ul>
        </div>
        </div>
      </div>

      <nav class="navbar navbar-expand-lg bg-body-tertiary rounded" aria-label="Thirteenth navbar example">
        <div class="container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample11" aria-controls="navbarsExample11" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse d-lg-flex" id="navbarsExample11">
          <div class="info" style="margin-left: 150px;">
              <div class="welcome">Welcome</div>
              <div class="name"></div>
              
          </div>
            <ul class="navbar-nav col-lg-6 justify-content-lg-center">
                <ul
                class="nav col-12 col-lg-auto my-2 justify-content-center my-md-0 text-small"
              >
              
                <li class="nav-icon">
                    <a href="HomePage.html" class="nav-link text-dark">
                      <svg class="bi d-block mx-auto mb-1" width="30" height="30">
                        <use xlink:href="#event" />
                      </svg>
                      Events
                    </a>
                  
                     
                    
                  
                    
                    
                      
                   
              </ul>
              
              
              </li>
            </ul>
           
          </div>
        </div>
    </nav>
    <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
        <symbol id="bootstrap" viewBox="0 0 118 94">
          <title>Bootstrap</title>
          <path fill-rule="evenodd" clip-rule="evenodd" d="M24.509 0c-6.733 0-11.715 5.893-11.492 12.284.214 6.14-.064 14.092-2.066 20.577C8.943 39.365 5.547 43.485 0 44.014v5.972c5.547.529 8.943 4.649 10.951 11.153 2.002 6.485 2.28 14.437 2.066 20.577C12.794 88.106 17.776 94 24.51 94H93.5c6.733 0 11.714-5.893 11.491-12.284-.214-6.14.064-14.092 2.066-20.577 2.009-6.504 5.396-10.624 10.943-11.153v-5.972c-5.547-.529-8.934-4.649-10.943-11.153-2.002-6.484-2.28-14.437-2.066-20.577C105.214 5.894 100.233 0 93.5 0H24.508zM80 57.863C80 66.663 73.436 72 62.543 72H44a2 2 0 01-2-2V24a2 2 0 012-2h18.437c9.083 0 15.044 4.92 15.044 12.474 0 5.302-4.01 10.049-9.119 10.88v.277C75.317 46.394 80 51.21 80 57.863zM60.521 28.34H49.948v14.934h8.905c6.884 0 10.68-2.772 10.68-7.727 0-4.643-3.264-7.207-9.012-7.207zM49.948 49.2v16.458H60.91c7.167 0 10.964-2.876 10.964-8.281 0-5.406-3.903-8.178-11.425-8.178H49.948z"></path>
        </symbol>
        <symbol id="home" viewBox="0 0 16 16">
          <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z"/>
        </symbol>
        <symbol id="profile" viewBox="0 0 16 16">
            <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664z"/>
        </symbol>
        <symbol id="signout" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"/>
    <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
        </symbol>
        <symbol id="football" height="30" width="30" viewBox="0 0 512 512">
            <path d="M417.3 360.1l-71.6-4.8c-5.2-.3-10.3 1.1-14.5 4.2s-7.2 7.4-8.4 12.5l-17.6 69.6C289.5 445.8 273 448 256 448s-33.5-2.2-49.2-6.4L189.2 372c-1.3-5-4.3-9.4-8.4-12.5s-9.3-4.5-14.5-4.2l-71.6 4.8c-17.6-27.2-28.5-59.2-30.4-93.6L125 228.3c4.4-2.8 7.6-7 9.2-11.9s1.4-10.2-.5-15l-26.7-66.6C128 109.2 155.3 89 186.7 76.9l55.2 46c4 3.3 9 5.1 14.1 5.1s10.2-1.8 14.1-5.1l55.2-46c31.3 12.1 58.7 32.3 79.6 57.9l-26.7 66.6c-1.9 4.8-2.1 10.1-.5 15s4.9 9.1 9.2 11.9l60.7 38.2c-1.9 34.4-12.8 66.4-30.4 93.6zM256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm14.1-325.7c-8.4-6.1-19.8-6.1-28.2 0L194 221c-8.4 6.1-11.9 16.9-8.7 26.8l18.3 56.3c3.2 9.9 12.4 16.6 22.8 16.6h59.2c10.4 0 19.6-6.7 22.8-16.6l18.3-56.3c3.2-9.9-.3-20.7-8.7-26.8l-47.9-34.8z"/>
        </symbol>
        <symbol id="event" height="30" width="30" viewBox=" 0 0 16 16">
            <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M8 7.993c1.664-1.711 5.825 1.283 0 5.132-5.825-3.85-1.664-6.843 0-5.132"/>
        </symbol>  
        <symbol id="ticket" height="30" width="30" viewBox=" 0 0 16 16">
            <path d="M0 4.5A1.5 1.5 0 0 1 1.5 3h13A1.5 1.5 0 0 1 16 4.5V6a.5.5 0 0 1-.5.5 1.5 1.5 0 0 0 0 3 .5.5 0 0 1 .5.5v1.5a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 0 11.5V10a.5.5 0 0 1 .5-.5 1.5 1.5 0 1 0 0-3A.5.5 0 0 1 0 6zm4 1a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5m0 5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5M4 8a1 1 0 0 0 1 1h6a1 1 0 1 0 0-2H5a1 1 0 0 0-1 1"/>
        </symbol>  
        <symbol id="user" height="30" width="30" viewBox=" 0 0 16 16">
            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"/>
        </symbol> 
        <symbol id="tournament" height="30" width="30" viewBox=" 0 0 16 16">
            <path d="M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5c0 .538-.012 1.05-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33.076 33.076 0 0 1 2.5.5m.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935zm10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935"/>
        </symbol>  
       <symbol id="stadium" viewBox="0 0 511.957 511.957" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M507.691,110.215l-42.667-32c-3.221-2.411-7.552-2.816-11.157-1.003c-3.605,1.813-5.888,5.504-5.888,9.536v95.637 c-36.373-10.987-89.365-16.235-132.117-18.709c-1.088-0.832-2.347-1.493-3.733-1.877c-2.923-0.811-5.888-0.235-8.32,1.237 c-20.373-1.003-37.419-1.387-47.829-1.515V134.77l38.4-28.8c2.688-2.005,4.267-5.184,4.267-8.533c0-3.349-1.579-6.528-4.267-8.533 l-42.667-32c-3.2-2.432-7.552-2.795-11.157-1.003c-3.627,1.813-5.909,5.504-5.909,9.536v96.085 c-10.411,0.149-27.456,0.533-47.829,1.515c-2.432-1.472-5.397-2.027-8.32-1.237c-1.408,0.384-2.667,1.045-3.733,1.877 c-52.16,3.029-119.616,10.155-153.451,26.816v-34.411l38.4-28.8c2.709-2.005,4.267-5.184,4.267-8.533 c0-3.349-1.579-6.528-4.267-8.533l-42.667-32c-3.221-2.411-7.509-2.816-11.157-1.003C2.283,79.026,0,82.717,0,86.749v128 c0,0.256,0.021,0.683,0.064,1.173l21.205,190.827c0,33.003,84.117,45.568,149.333,50.368v-71.701c0-17.643,14.357-32,32-32h85.333 c17.643,0,32,14.357,32,32v71.765c65.216-4.693,149.312-17.003,149.269-49.259l21.141-190.229c0-0.085,0.021-0.192,0.021-0.277 c0.043-0.491,0.107-1.003,0.149-1.472c0.043-0.491,0.064-0.917,0.064-1.173c0-9.771-8.107-17.749-21.333-24.256v-34.411 l38.443-28.821c2.688-2.005,4.267-5.184,4.267-8.533C511.957,115.399,510.379,112.221,507.691,110.215z M21.76,214.834 c3.499-4.779,18.347-10.859,43.648-16.469c0.299,0.576,0.469,1.195,0.875,1.707l29.333,36.672 C51.627,229.959,26.24,221.127,21.76,214.834z M125.675,240.647c-0.277-0.448-0.384-1.003-0.747-1.451l-36.245-45.312 c22.933-3.84,51.285-7.147,85.013-9.131l16.576,60.757C166.336,244.466,144.789,242.759,125.675,240.647z M277.995,246.301 c-2.539,0.064-4.949,0.171-7.531,0.213c-8.171,0.149-16.555,0.235-25.173,0.235c-8.64,0-17.045-0.085-25.237-0.235 c-2.56-0.043-4.949-0.149-7.467-0.213l-17.067-62.592c15.637-0.619,32.213-0.96,49.771-0.96c17.557,0,34.133,0.341,49.771,0.96 L277.995,246.301z M364.907,240.669c-2.624,0.299-5.141,0.597-7.872,0.875c-2.901,0.299-6.037,0.555-9.045,0.811 c-3.456,0.32-6.827,0.64-10.432,0.939c-3.605,0.277-7.445,0.512-11.179,0.768c-3.243,0.213-6.357,0.469-9.707,0.661 c-4.352,0.256-8.96,0.448-13.504,0.661c-0.96,0.043-1.877,0.085-2.837,0.128l16.576-60.779c33.771,2.005,62.165,5.269,85.12,9.003 l-36.373,45.483C365.291,239.666,365.184,240.199,364.907,240.669z M469.376,213.789l-0.064,0.277 c-0.192,0.341-0.597,0.725-0.917,1.088c-0.363,0.405-0.619,0.789-1.131,1.216c-0.448,0.363-1.088,0.747-1.643,1.109 c-0.683,0.448-1.28,0.896-2.133,1.365c-0.661,0.363-1.536,0.747-2.283,1.109c-1.003,0.491-1.941,0.981-3.136,1.493 c-0.875,0.384-1.963,0.747-2.944,1.131c-1.344,0.512-2.624,1.045-4.139,1.557c-1.088,0.384-2.389,0.747-3.584,1.131 c-1.664,0.533-3.264,1.067-5.12,1.6c-1.323,0.384-2.837,0.747-4.245,1.131c-2.005,0.533-3.925,1.067-6.101,1.6 c-1.451,0.341-3.093,0.683-4.608,1.045c-2.389,0.555-4.736,1.088-7.317,1.621c-1.664,0.341-3.52,0.661-5.248,1.003 c-2.688,0.512-5.291,1.045-8.171,1.557c-2.069,0.363-4.331,0.704-6.485,1.067c-1.685,0.277-3.349,0.555-5.099,0.832l29.312-36.629 c0.491-0.619,0.704-1.344,1.045-2.027C451.648,203.655,466.773,209.629,469.376,213.789z"></path> </g> </g> </g></symbol>
        <symbol id="team" viewBox="0 0 459.413 459.413" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M446.06,252.506c-52.807-56.162-33.378-166.647-23.988-207c1.979-8.443-1.892-11.123-9.883-7.738 C344.655,66.429,241.721,7.436,230.259,0.651V0c0,0-0.222,0.134-0.553,0.328C229.386,0.134,229.159,0,229.159,0v0.651 C217.698,7.443,114.761,66.429,47.229,37.768c-7.985-3.384-11.856-0.697-9.887,7.738c9.399,40.345,28.817,150.83-23.984,207 c-5.941,6.319-4.593,10.535,4.076,10.535h30.224c0,0,6.562,131.548,181.502,195.943v0.429c0.188-0.076,0.361-0.145,0.547-0.212 c0.188,0.067,0.36,0.136,0.553,0.212v-0.429c174.94-64.396,181.5-195.943,181.5-195.943h30.22 C450.651,263.041,451.994,258.825,446.06,252.506z M231.562,346.199c-0.441,0-0.866-0.064-1.303-0.064 c-0.373,0-0.725-0.044-1.092-0.052c-72.46-1.294-131.031-60.54-131.031-133.307c0-72.767,58.57-132.012,131.031-133.307 c0.367-0.008,0.719-0.054,1.092-0.054c0.437-0.008,0.862-0.064,1.303-0.064c73.576,0,133.435,59.859,133.435,133.434 C364.997,286.353,305.138,346.199,231.562,346.199z"></path> <path d="M230.275,177.032c-0.008,0-0.016,0-0.024,0c-0.379,0-0.723,0.102-1.092,0.11c-19.211,0.605-34.63,16.276-34.63,35.634 c0,19.36,15.418,35.033,34.63,35.63c0.369,0.016,0.722,0.112,1.092,0.112c0.008,0,0.016,0,0.024,0 c19.74,0,35.738-15.998,35.738-35.743S250.016,177.032,230.275,177.032z"></path> <path d="M231.562,91.119c-0.441,0-0.866,0.064-1.303,0.064c-0.373,0-0.725,0.046-1.092,0.054 c-65.966,1.296-119.255,55.258-119.255,121.531c0,66.271,53.289,120.235,119.255,121.529c0.367,0.009,0.719,0.057,1.092,0.057 c0.437,0.008,0.862,0.068,1.303,0.068c67.08,0,121.658-54.586,121.658-121.662C353.22,145.68,298.642,91.119,231.562,91.119z M311.578,266.588c-12.23-9.658-29.815-10.508-43.071-0.934c-13.261,9.581-17.97,26.573-12.62,41.216 c-8.163,2.229-16.751,3.435-25.611,3.435c-0.008,0-0.016,0-0.024,0c-0.371,0-0.731-0.032-1.092-0.032 c-8.966-0.108-17.641-1.418-25.874-3.795c5.566-14.559,1.104-31.606-12.014-41.389c-13.108-9.786-30.699-9.185-43.066,0.288 c-9.131-14.197-14.689-30.893-15.378-48.826c15.575,0.706,30.36-8.87,35.521-24.397c5.16-15.513-0.92-32.031-13.8-40.802 c10.811-13.305,25.043-23.708,41.349-29.867c4.144,14.653,17.389,25.425,33.246,25.92c0.369,0.008,0.721,0.096,1.09,0.096 c0.01,0,0.018,0,0.026,0c16.359,0,30.128-11.006,34.368-26.016c16.852,6.366,31.462,17.26,42.395,31.198 c-13.016,8.54-19.388,24.946-14.495,40.547c4.897,15.613,19.524,25.449,35.109,25.008 C326.662,236.047,320.875,252.582,311.578,266.588z"></path> </g> </g> </g></svg>
    </svg>
         
    </svg>
    <div class="container">
    
  
<div class="container">
<div>
  <div class="d-flex justify-content-end">
<button class="button button-black width-auto  book-ticket-btn" style="margin : 1px; margin-top: 1%;"  id="addNewmatchButton" type="submit"  name="add">Add new event</button>
</div>
  <div id="addEventFormContainer" style="display:none; padding:10px; border:1px solid #ccc; margin-top:10px;">
  <form id="addEventForm">
    <input type="text" name="EventName" placeholder="Event Name" required /><br/><br/>
    <input type="date" name="EventDate" required /><br/><br/>
    <input type="text" name="EventLocation" placeholder="Event Location" required /><br/><br/>
    <input type="time" name="EventTime" required /><br/><br/>
    <input type="text" name="EventDescription" placeholder="Event Description" required /><br/><br/>
    <input type="text" name="EventImage" placeholder="Event Image URL" required /><br/><br/>
    <input type="text" name="EventCategory" placeholder="Event Category (comma separated)" required /><br/><br/>
    
    <div id="pricesContainer"></div>
    <button type="button" id="addPriceRowBtn">Add Ticket Price</button><br/><br/>
    
    <button type="submit">Submit</button>
    <button type="button" id="cancelAddEventBtn">Cancel</button>
  </form>
</div>



        <h5 style="font-weight : bold; margin: 1%;" for="myDropdown">Select events </h5>
        <div>
        <select id="myDropdown" name="myDropdown" class="form-control" onchange="this.form.submit()">
        <option value="">Select an event</option>
        
        </select>
  

      
        </div>
      <form method="" action="">
      <div class="container-fluid">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample11" aria-controls="navbarsExample11" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id = "eventActions" class="d-flex justify-content-end">
      <input type="hidden" name="event_id" value='.$selectedOption.'>
      
      <button id = "deleteBtn" class="button button-black width-auto  deleteBtn" style="margin : 1px;"  type="submit" name="deleteBtn">Delete</button>
        <button id = "editBtn" class="button button-black width-auto book-ticket-btn editAllButton" style="margin : 1px;"  type="button" name="edit">Edit</button>
        <button id="confirmEditBtn" class="button button-black width-auto book-ticket-btn" style="margin : 1px;"  type="submit" name="save" >Confirm Edit </button>
      </div>
      </div>
      </form>

          
</div>

      


<script type="module">
  import { getEvents, getEventById, deleteEvent, editEvent, createEvent } from './api.js';

  // Grab DOM elements
  const dropdown = document.getElementById('myDropdown');
  const eventActions = document.getElementById('eventActions');
  const deleteBtn      = document.getElementById('deleteBtn');
  const editBtn        = document.getElementById('editBtn');
  const confirmEditBtn = document.getElementById('confirmEditBtn');
  const addBtn         = document.getElementById('addNewmatchButton');
  const formContainer  = document.getElementById('addEventFormContainer');
  const cancelBtn      = document.getElementById('cancelAddEventBtn');
  const priceRowBtn    = document.getElementById('addPriceRowBtn');
  const addForm        = document.getElementById('addEventForm');
  const pricesContainer= document.getElementById('pricesContainer');

  let allEvents = [];
  let selectedEventId = null;
  let editedEventData = null;

  // —————————————————————
  // 1) Load & cache all events
  // —————————————————————
  async function loadEvents() {
    try {
      const resp = await getEvents({ page:1, limit:100 });
      // your API returns: { total, currentPage, totalPages, Events: [...] }
      allEvents = resp.Events || [];
      dropdown.innerHTML = '<option value="">Select an event</option>';
      allEvents.forEach(ev => {
        const o = document.createElement('option');
        o.value = ev._id;
        o.textContent = ev.EventName;
        dropdown.appendChild(o);
      });
    } catch (err) {
      console.error('Failed to load events:', err);
      alert('Could not load events.');
    }
  }
  await loadEvents();

  // —————————————————————
  // 2) When user picks one
  // —————————————————————
  dropdown.addEventListener('change', async () => {
    selectedEventId = dropdown.value;
    if (!selectedEventId) {
      eventActions.style.display = 'none';
      return;
    }
    // show buttons
    eventActions.style.display = 'block';

    // find the full object in cache
    editedEventData = allEvents.find(ev => ev._id === selectedEventId);
    console.log('Selected event data:', editedEventData);
  });

  // —————————————————————
  // 3) Delete
  // —————————————————————
  deleteBtn.addEventListener('click', async () => {
    if (!selectedEventId) return alert('Select an event first.');
    if (!confirm('Delete this event?')) return;
    try {
      await deleteEvent(selectedEventId);
      alert('Deleted!');
      // remove from cache & UI
      allEvents = allEvents.filter(ev => ev._id !== selectedEventId);
      dropdown.querySelector(`option[value="${selectedEventId}"]`).remove();
      dropdown.value = '';
      eventActions.style.display = 'none';
    } catch (err) {
      console.error(err);
      alert('Delete failed: ' + err.message);
    }
  });

  // —————————————————————
  // 4) Edit (prep)
  // —————————————————————
  editBtn.addEventListener('click', () => {
    if (!editedEventData) return alert('No event selected.');
    // You'd prefill your edit form here.
    // For now:
    alert(`Ready to edit: ${editedEventData.EventName}`);
  });

  // —————————————————————
  // 5) Confirm Edit
  // —————————————————————
  confirmEditBtn.addEventListener('click', async () => {
    if (!editedEventData) return alert('No data to update.');
    try {
      await editEvent(selectedEventId, editedEventData);
      alert('Updated!');
      await loadEvents();
    } catch (err) {
      console.error(err);
      alert('Update failed: ' + err.message);
    }
  });

  // —————————————————————
  // 6) Show Add‑Event form
  // —————————————————————
  addBtn.addEventListener('click', e => {
    e.preventDefault();
    formContainer.style.display = 'block';
  });
  cancelBtn.addEventListener('click', () => {
    formContainer.style.display = 'none';
    addForm.reset();
    pricesContainer.innerHTML = '';
  });

  // —————————————————————
  // 7) Dynamic ticket‑price rows
  // —————————————————————
  priceRowBtn.addEventListener('click', () => {
    const row = document.createElement('div');
    row.className = 'price-row';
    row.innerHTML = `
      <input name="ticketType" placeholder="Ticket Type" required>
      <input name="price" type="number" placeholder="Price" required>
      <button type="button" class="removePriceBtn">Remove</button>
    `;
    pricesContainer.appendChild(row);
    row.querySelector('.removePriceBtn').onclick = () => row.remove();
  });

  // —————————————————————
  // 8) Submit new event
  // —————————————————————
  addForm.addEventListener('submit', async e => {
    e.preventDefault();
    const f = e.target;
    const payload = {
      EventName:        f.EventName.value.trim(),
      EventDate:        f.EventDate.value,
      EventLocation:    f.EventLocation.value.trim(),
      EventTime:        f.EventTime.value,
      EventDescription: f.EventDescription.value.trim(),
      EventImage:       f.EventImage.value.trim(),
      EventCategory:    f.EventCategory.value.split(',').map(s=>s.trim()).filter(Boolean),
      EventPrices: Array.from(pricesContainer.querySelectorAll('.price-row')).map(r=>({
        ticketType: r.querySelector('[name="ticketType"]').value.trim(),
        price:      Number(r.querySelector('[name="price"]').value)
      }))
    };

    try {
      await createEvent(payload);
      alert('Event added!');
      addForm.reset();
      pricesContainer.innerHTML = '';
      formContainer.style.display = 'none';
      await loadEvents();
    } catch (err) {
      console.error(err);
      alert('Add failed: ' + err.message);
    }
  });
</script>


</body>



</html>